import { relations } from 'drizzle-orm';
import { integer, pgTable, serial } from 'drizzle-orm/pg-core';
import { createInsertSchema, createSelectSchema } from 'drizzle-zod';

import { baseEntity } from '@/schemas/base';
import { organizations } from '@/schemas/organization';

export const {{name_plural}} = pgTable('{{name_singular}}', {
    ...baseEntity,
    id: serial('id').primaryKey(),
    organizationId: integer('organizationId')
        .notNull()
        .references(() => organizations.id),

    // TODO: Add types here
});

export const {{name_plural}}Relations = relations({{name_plural}}, ({ one }) => ({
    organization: one(organizations, {
        fields: [{{name_plural}}.organizationId],
        references: [organizations.id],
    }),
}));

export type {{properCase name_singular}} = typeof {{name_plural}}.$inferSelect;
export type New{{properCase name_singular}} = typeof {{name_plural}}.$inferInsert;

export const select{{properCase name_singular}}Schema = createSelectSchema({{name_plural}});
export const insert{{properCase name_singular}}Schema = createInsertSchema({{name_plural}});
export const update{{properCase name_singular}}Schema = insert{{properCase name_singular}}Schema;
